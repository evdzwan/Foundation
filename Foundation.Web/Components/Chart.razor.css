@property --value {
    inherits: false;
    initial-value: 0;
    syntax: "<number>";
}

@property --value-offset {
    inherits: false;
    initial-value: 0;
    syntax: "<number>";
}

@property --value-prev {
    inherits: false;
    initial-value: 0;
    syntax: "<number>";
}

.chart {
    --chart-bg: inherit;
    --chart-fg: inherit;
    --count: 1;
    --gap: 0;
    --padding: 0;
    --value-max: 1;
    --value-sum: 1;
    background-color: var(--chart-bg);
    color: var(--chart-fg);
    display: block;
    overflow: hidden;
    position: relative;
    user-select: none;
}

    .chart > .entity {
        --entity-bg: hsl(calc(var(--index) / var(--count) * 360deg), 70%, 60%);
        --entity-fg: hsl(calc(var(--index) / var(--count) * 360deg + 180deg), 70%, 60%);
        --index: 0;
        --value: 0;
        --value-offset: 0;
        --value-prev: 0;
        background-color: var(--entity-bg);
        color: var(--entity-fg);
        inset: 0;
        position: absolute;
    }

    .chart.area {
        --horizontal-space: calc(100% - var(--padding) * 2 - var(--gap) * (var(--count) - 1));
    }

        .chart.area > .entity {
            --gap-offset: calc(var(--gap) * var(--index));
            --bar-p-lt: calc(var(--padding) + var(--gap-offset) + var(--index) / var(--count) * var(--horizontal-space)) calc(100% - (var(--padding) + var(--value-prev) / var(--value-max) * (100% - var(--padding) * 2)));
            --bar-p-rt: calc(var(--padding) + var(--gap-offset) + (var(--index) + 1) / var(--count) * var(--horizontal-space)) calc(100% - (var(--padding) + var(--value) / var(--value-max) * (100% - var(--padding) * 2)));
            --bar-p-rb: calc(var(--padding) + var(--gap-offset) + (var(--index) + 1) / var(--count) * var(--horizontal-space)) calc(100% - var(--padding));
            --bar-p-lb: calc(var(--padding) + var(--gap-offset) + var(--index) / var(--count) * var(--horizontal-space)) calc(100% - var(--padding));
            clip-path: polygon(var(--bar-p-lt), var(--bar-p-rt), var(--bar-p-rb), var(--bar-p-lb));
        }

    .chart.bar {
        --horizontal-space: calc(100% - var(--padding) * 2 - var(--gap) * (var(--count) - 1));
    }

        .chart.bar > .entity {
            --gap-offset: calc(var(--gap) * var(--index));
            --bar-p-lt: calc(var(--padding) + var(--gap-offset) + var(--index) / var(--count) * var(--horizontal-space)) calc(100% - (var(--padding) + var(--value) / var(--value-max) * (100% - var(--padding) * 2)));
            --bar-p-rt: calc(var(--padding) + var(--gap-offset) + (var(--index) + 1) / var(--count) * var(--horizontal-space)) calc(100% - (var(--padding) + var(--value) / var(--value-max) * (100% - var(--padding) * 2)));
            --bar-p-rb: calc(var(--padding) + var(--gap-offset) + (var(--index) + 1) / var(--count) * var(--horizontal-space)) calc(100% - var(--padding));
            --bar-p-lb: calc(var(--padding) + var(--gap-offset) + var(--index) / var(--count) * var(--horizontal-space)) calc(100% - var(--padding));
            clip-path: polygon(var(--bar-p-lt), var(--bar-p-rt), var(--bar-p-rb), var(--bar-p-lb));
        }

    .chart.donut {
        --ring-size: 10%;
    }

        .chart.donut::after {
            aspect-ratio: 1;
            background-color: var(--chart-bg);
            border-radius: 50%;
            content: '';
            height: min(calc(100% - (var(--padding) + var(--ring-size)) * 2), calc(100% - (var(--padding) + var(--ring-size)) * 2));
            left: 50%;
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .chart.donut > .entity {
            --angle-start: calc((var(--value-offset) / var(--value-sum)) * 360deg);
            --angle-end: calc(((var(--value-offset) + var(--value)) / var(--value-sum)) * 360deg);
            --slice-p-center: 50% 50%;
            --slice-p-start: calc(50% + sin(var(--angle-start)) * 100%) calc(50% - cos(var(--angle-start)) * 100%);
            --slice-p-end: calc(50% + sin(var(--angle-end)) * 100%) calc(50% - cos(var(--angle-end)) * 100%);
            aspect-ratio: 1;
            border-radius: 50%;
            clip-path: polygon(var(--slice-p-center), var(--slice-p-start), var(--slice-p-end));
            height: min(calc(100% - var(--padding) * 2), calc(100% - var(--padding) * 2));
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

    .chart.dot {
        --dot-size: 0;
        --horizontal-space: calc(100% - var(--padding) * 2);
    }

        .chart.dot > .entity {
            --dot-p-center: calc(var(--padding) + var(--index) / (var(--count) - 1) * var(--horizontal-space)) calc(100% - (var(--padding) + var(--value) / var(--value-max) * (100% - var(--padding) * 2)));
            clip-path: circle(calc(var(--dot-size) / 2) at var(--dot-p-center));
        }

    .chart.pie {
    }

        .chart.pie > .entity {
            --angle-start: calc((var(--value-offset) / var(--value-sum)) * 360deg);
            --angle-end: calc(((var(--value-offset) + var(--value)) / var(--value-sum)) * 360deg);
            --slice-p-center: 50% 50%;
            --slice-p-start: calc(50% + sin(var(--angle-start)) * 100%) calc(50% - cos(var(--angle-start)) * 100%);
            --slice-p-end: calc(50% + sin(var(--angle-end)) * 100%) calc(50% - cos(var(--angle-end)) * 100%);
            aspect-ratio: 1;
            border-radius: 50%;
            clip-path: polygon(var(--slice-p-center), var(--slice-p-start), var(--slice-p-end));
            height: min(calc(100% - var(--padding) * 2), calc(100% - var(--padding) * 2));
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

    .chart.waterfall {
        --vertical-space: calc(100% - var(--padding) * 2 - var(--gap) * (var(--count) - 1));
    }

        .chart.waterfall > .entity {
            --gap-offset: calc(var(--gap) * var(--index));
            --bar-p-lt: calc(var(--padding) + var(--value-offset) / var(--value-sum) * (100% - var(--padding) * 2)) calc(var(--padding) + var(--gap-offset) + var(--index) / var(--count) * var(--vertical-space));
            --bar-p-rt: calc(var(--padding) + (var(--value) + var(--value-offset)) / var(--value-sum) * (100% - var(--padding) * 2)) calc(var(--padding) + var(--gap-offset) + var(--index) / var(--count) * var(--vertical-space));
            --bar-p-rb: calc(var(--padding) + (var(--value) + var(--value-offset)) / var(--value-sum) * (100% - var(--padding) * 2)) calc(var(--padding) + var(--gap-offset) + (var(--index) + 1) / var(--count) * var(--vertical-space));
            --bar-p-lb: calc(var(--padding) + var(--value-offset) / var(--value-sum) * (100% - var(--padding) * 2)) calc(var(--padding) + var(--gap-offset) + (var(--index) + 1) / var(--count) * var(--vertical-space));
            clip-path: polygon(var(--bar-p-lt), var(--bar-p-rt), var(--bar-p-rb), var(--bar-p-lb));
        }
